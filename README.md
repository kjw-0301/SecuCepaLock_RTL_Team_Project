# 스마트 금고설계(RTL Project)
### 💻개발배경
**RFID기능으로 동작하는 금고를 설계하고자 계획했습니다. 등록된 카드만 금고의 문을 열 수 있으며, 내부에는 2중으로 키패드로 비밀번호를 입력하는 2중 보안 시스템을 갖춘 금고를 설계하고자 계획했습니다.**
#### #📌 SPI통신으로 주어진 RC522로 RFID기능을 구현하려 했습니다. 처음 저희 팀의 목표는 배우지 않은 내용인 SPI통신과 사용해보지 않은 RC522의 데이터시트를 분석하여 RC522의 모듈을 설계하고자 했으나, 주어진 프로젝트 기간이 짧았던 점, 도전하고자 했던 RC522의 데이터시트 분석이 생각보다 난이도가 높았고 시간이 오래걸려 RFID 기능은 미완성으로 프로젝트를 마무리했습니다. 하지만 추후에 Verilog언어로 RC522의 SPI통신 프로토콜을 설계한 모듈을 팀원들과 분석하여 미완성인 프로젝트를 완성시키도록 계획하고 있습니다.  
## 기능설명
1.  초기상태에서 LCD에는 “Enter Password”를 출력하고, open 버튼을 누르면 0번 LED ON 됩니다.
2.  비밀번호가 맞게 입력하면 1번 LED ON, LCD는“OPEN”상태의 메시지를 표시하고 금고의 문이 열립니다.
3. 금고가 open인 상황에서 금고 문을 닫고 사용자가 멀어진다면 자동으로 문의 잠금 장치가 잠기게됩니다.
4. 만약, 틀린 비밀번호를 입력하게 된다면 LCD는 “ERROR”상태의 메시지를 표시합니다.
5.  “ERROR”상태에서 OPEN버튼을 누르면 다시 비밀번호 입력모드로 되돌아갑니다.
## 상세 코드 설명
| 기능 | 설명 |
| --- | --- | 
| **모듈 설계** | 하나의 모듈로 설계되었으며, GitHub 레포지토리의 **Safety_Box.v**에서 확인할 수 있습니다. | 
| **키패드 입력 처리** | - **EDGE_DETECTOR** 모듈에서 키패드의 상승 엣지와 하강 엣지를 감지하여 **key_valid_p**로 비밀번호 입력을 인식합니다.<br>- FSM을 통해 상태를 제어합니다. |
| **상태 전이** | - 비밀번호 입력 시 각 상태(State)에서 맞는 **key_value**가 입력되면 다음 상태로 이동합니다.<br>- 비밀번호 입력 중 오류 발생 시 **ERROR**에 **1** 할당.<br>- 비밀번호가 올바르게 입력되면 **OPEN**에 **1** 할당. | 
|**LCD 모듈**| - **I2C_txtLCD_top LCD** 모듈은 **SUB_CODE.v**에 포함되어 있습니다.<br>- 초기화 작업은 **Flag**로 선언하여 한 번만 수행됩니다.|
|**대기 상태**|- IDLE 상태에서 **키패드 입력(key_valid_p), open, error** 값 할당을 대기합니다.|
|**상태 변화 및 메시지 출력**|- **key_valid**의 **상승 엣지**가 발생하면 **SEND_PASSWARD** 상태로 전환, **LCD**에 ✱ 표시.<br>- **OPEN** 시 **SEND_ENTER** 상태로 전환, **LCD**에 "Welcome!!" 출력.<br>- **ERROR**가 **1**일 경우 **SEND_ERROR** 상태로 전환, **LCD**에 "비밀번호가 틀렸습니다." 메시지 출력.|
|**문 닫힘 처리**|- **HC_SR04** 센서에서 받은 거리 값(distance_bcd)이 30cm이상일 경우 자동으로 금고 문이 닫힙니다.|
|**비밀번호 입력 제한 시간**|- 비밀번호 입력 제한 시간(10초)을 넘기면 초기 화면으로 돌아가도록 설계되어 있습니다|



